<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Application de l’Analyse en Composantes Principales pour étudier l’adaptation biologique en génomique des populations.</title>
  <meta name="description" content="Application de l’Analyse en Composantes Principales pour étudier l’adaptation biologique en génomique des populations.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Application de l’Analyse en Composantes Principales pour étudier l’adaptation biologique en génomique des populations." />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Application de l’Analyse en Composantes Principales pour étudier l’adaptation biologique en génomique des populations." />
  
  
  

<meta name="author" content="Keurcien LUU">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introgression-adaptative.html">
<link rel="next" href="perspectives-et-conclusions.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#la-genetique-des-populations"><i class="fa fa-check"></i><b>1.1</b> La génétique des populations</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#levolution-comme-point-de-depart"><i class="fa fa-check"></i><b>1.1.1</b> L’évolution comme point de départ</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#a-lorigine-de-la-variabilite-genetique"><i class="fa fa-check"></i><b>1.2</b> À l’origine de la variabilité génétique</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#la-theorie-de-levolution"><i class="fa fa-check"></i><b>1.2.1</b> La théorie de l’évolution</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#levolution-dune-theorie"><i class="fa fa-check"></i><b>1.2.2</b> L’évolution d’une théorie</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction.html"><a href="introduction.html#forces-evolutives"><i class="fa fa-check"></i><b>1.2.3</b> Forces évolutives</a></li>
<li class="chapter" data-level="1.2.4" data-path="introduction.html"><a href="introduction.html#adaptation-locale"><i class="fa fa-check"></i><b>1.2.4</b> Adaptation locale</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#donnees-de-polymorphismes-genetiques"><i class="fa fa-check"></i><b>1.3</b> Données de polymorphismes génétiques</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#des-donnees-en-grande-dimension"><i class="fa fa-check"></i><b>1.3.1</b> Des données en grande dimension</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#les-marqueurs-genetiques"><i class="fa fa-check"></i><b>1.3.2</b> Les marqueurs génétiques</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#encodage-des-donnees-genetiques"><i class="fa fa-check"></i><b>1.3.3</b> Encodage des données génétiques</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#les-motivations-de-la-these"><i class="fa fa-check"></i><b>1.4</b> Les motivations de la thèse</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#resultats-principaux-et-organisation-du-manuscript"><i class="fa fa-check"></i><b>1.4.1</b> Résultats principaux et organisation du manuscript</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html"><i class="fa fa-check"></i><b>2</b> Adaptation locale</a><ul>
<li class="chapter" data-level="2.1" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#letat-de-lart-pour-les-scans-genomiques"><i class="fa fa-check"></i><b>2.1</b> L’état de l’art pour les scans génomiques</a><ul>
<li class="chapter" data-level="2.1.1" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#modeles-demographiques"><i class="fa fa-check"></i><b>2.1.1</b> Modèles démographiques</a></li>
<li class="chapter" data-level="2.1.2" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#lindice-de-fixation"><i class="fa fa-check"></i><b>2.1.2</b> L’indice de fixation</a></li>
<li class="chapter" data-level="2.1.3" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#test-de-lewontin-krakauer"><i class="fa fa-check"></i><b>2.1.3</b> Test de Lewontin-Krakauer</a></li>
<li class="chapter" data-level="2.1.4" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#le-modele-f"><i class="fa fa-check"></i><b>2.1.4</b> Le modèle <span class="math inline">\(F\)</span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#lanalyse-en-composantes-principales-en-genetique-des-populations"><i class="fa fa-check"></i><b>2.2</b> L’Analyse en Composantes Principales en génétique des populations</a><ul>
<li class="chapter" data-level="2.2.1" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#principe-de-lanalyse-en-composantes-principales"><i class="fa fa-check"></i><b>2.2.1</b> Principe de l’Analyse en Composantes Principales</a></li>
<li class="chapter" data-level="2.2.2" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#apparentement-genetique-interindividuel"><i class="fa fa-check"></i><b>2.2.2</b> Apparentement génétique interindividuel</a></li>
<li class="chapter" data-level="2.2.3" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#applications-en-genetique-des-populations"><i class="fa fa-check"></i><b>2.2.3</b> Applications en génétique des populations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#statistiques-de-test-basees-sur-lanalyse-en-composantes-principales"><i class="fa fa-check"></i><b>2.3</b> Statistiques de test basées sur l’Analyse en Composantes Principales</a><ul>
<li class="chapter" data-level="2.3.1" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#la-communalite"><i class="fa fa-check"></i><b>2.3.1</b> La communalité</a></li>
<li class="chapter" data-level="2.3.2" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#la-distance-robuste-de-mahalanobis"><i class="fa fa-check"></i><b>2.3.2</b> La distance robuste de Mahalanobis</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#article-1"><i class="fa fa-check"></i><b>2.4</b> Article 1</a><ul>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#abstract"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#significance-statement"><i class="fa fa-check"></i>Significance Statement</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#new-method"><i class="fa fa-check"></i>New Method</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#discussion"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#materials-and-methods"><i class="fa fa-check"></i>Materials and Methods</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#article-2"><i class="fa fa-check"></i><b>2.5</b> Article 2</a><ul>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#abstract-1"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#introduction-2"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#statistical-and-computational-approach"><i class="fa fa-check"></i>Statistical and computational approach</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#materials-and-methods-1"><i class="fa fa-check"></i>Materials and methods</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#results-1"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#discussion-1"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#data-accessibility"><i class="fa fa-check"></i>Data accessibility</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html"><i class="fa fa-check"></i><b>3</b> Introgression adaptative</a><ul>
<li class="chapter" data-level="3.1" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#introgression-par-metissage"><i class="fa fa-check"></i><b>3.1</b> Introgression par métissage</a><ul>
<li class="chapter" data-level="3.1.1" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#coefficients-de-metissage-locaux"><i class="fa fa-check"></i><b>3.1.1</b> Coefficients de métissage locaux</a></li>
<li class="chapter" data-level="3.1.2" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#statistique-de-test"><i class="fa fa-check"></i><b>3.1.2</b> Statistique de test</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#introgression-par-flux-de-genes"><i class="fa fa-check"></i><b>3.2</b> Introgression par flux de gènes</a><ul>
<li class="chapter" data-level="3.2.1" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#diversite-nucleotidique-par-paires-de-sequences"><i class="fa fa-check"></i><b>3.2.1</b> Diversité nucléotidique par paires de séquences</a></li>
<li class="chapter" data-level="3.2.2" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#le-modele-abba-baba"><i class="fa fa-check"></i><b>3.2.2</b> Le modèle ABBA-BABA</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#une-nouvelle-statistique-pour-les-scans-dintrogression"><i class="fa fa-check"></i><b>3.3</b> Une nouvelle statistique pour les scans d’introgression</a><ul>
<li class="chapter" data-level="3.3.1" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#analyse-en-composantes-principales-locale"><i class="fa fa-check"></i><b>3.3.1</b> Analyse en Composantes Principales locale</a></li>
<li class="chapter" data-level="3.3.2" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#resultats-principaux"><i class="fa fa-check"></i><b>3.3.2</b> Résultats principaux</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#article-3"><i class="fa fa-check"></i><b>3.4</b> Article 3</a><ul>
<li class="chapter" data-level="" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#scanning-genomes-for-adaptive-introgression-using-principal-component-analysis"><i class="fa fa-check"></i>Scanning genomes for adaptive introgression using principal component analysis</a></li>
<li class="chapter" data-level="" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#introduction-3"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#a-pca-based-approach-to-detect-local-introgression"><i class="fa fa-check"></i>A PCA-based approach to detect local introgression</a></li>
<li class="chapter" data-level="" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#materials-and-methods-2"><i class="fa fa-check"></i>Materials and Methods</a></li>
<li class="chapter" data-level="" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#results-2"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#discussion-2"><i class="fa fa-check"></i>Discussion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="aspect-computationnel.html"><a href="aspect-computationnel.html"><i class="fa fa-check"></i><b>4</b> Aspect computationnel</a><ul>
<li class="chapter" data-level="4.1" data-path="aspect-computationnel.html"><a href="aspect-computationnel.html#evolution-de-pcadapt"><i class="fa fa-check"></i><b>4.1</b> Évolution de pcadapt</a><ul>
<li class="chapter" data-level="4.1.1" data-path="aspect-computationnel.html"><a href="aspect-computationnel.html#du-langage-c-au-langage-r"><i class="fa fa-check"></i><b>4.1.1</b> Du langage C au langage R</a></li>
<li class="chapter" data-level="4.1.2" data-path="aspect-computationnel.html"><a href="aspect-computationnel.html#du-calcul-de-la-matrice-de-covariance-a-lalgorithme-iram"><i class="fa fa-check"></i><b>4.1.2</b> Du calcul de la matrice de covariance à l’algorithme IRAM</a></li>
<li class="chapter" data-level="4.1.3" data-path="aspect-computationnel.html"><a href="aspect-computationnel.html#du-format-.pcadapt-au-format-.bed"><i class="fa fa-check"></i><b>4.1.3</b> Du format .pcadapt au format .bed</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="aspect-computationnel.html"><a href="aspect-computationnel.html#interface-shiny"><i class="fa fa-check"></i><b>4.2</b> Interface Shiny</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="perspectives-et-conclusions.html"><a href="perspectives-et-conclusions.html"><i class="fa fa-check"></i><b>5</b> Perspectives et conclusions</a><ul>
<li class="chapter" data-level="5.1" data-path="perspectives-et-conclusions.html"><a href="perspectives-et-conclusions.html#substitution-de-lanalyse-en-composantes-principales"><i class="fa fa-check"></i><b>5.1</b> Substitution de l’Analyse en Composantes Principales</a></li>
<li class="chapter" data-level="5.2" data-path="perspectives-et-conclusions.html"><a href="perspectives-et-conclusions.html#utilisation-du-desequilibre-de-liaison-pour-ameliorer-linference-de-la-structure"><i class="fa fa-check"></i><b>5.2</b> Utilisation du déséquilibre de liaison pour améliorer l’inférence de la structure</a></li>
<li class="chapter" data-level="5.3" data-path="perspectives-et-conclusions.html"><a href="perspectives-et-conclusions.html#utilisation-de-variables-environnementales"><i class="fa fa-check"></i><b>5.3</b> Utilisation de variables environnementales</a></li>
<li class="chapter" data-level="5.4" data-path="perspectives-et-conclusions.html"><a href="perspectives-et-conclusions.html#introgression-et-donnees-manquantes"><i class="fa fa-check"></i><b>5.4</b> Introgression et données manquantes</a></li>
<li class="chapter" data-level="5.5" data-path="perspectives-et-conclusions.html"><a href="perspectives-et-conclusions.html#conclusion"><i class="fa fa-check"></i><b>5.5</b> Conclusion</a></li>
</ul></li>
<li class="appendix"><span><b>Appendice</b></span></li>
<li class="chapter" data-level="A" data-path="details.html"><a href="details.html"><i class="fa fa-check"></i><b>A</b> Détails</a><ul>
<li class="chapter" data-level="" data-path="details.html"><a href="details.html#rapport-entre-la-communalite-et-lindice-de-fixation"><i class="fa fa-check"></i>Rapport entre la communalité et l’indice de fixation</a></li>
<li><a href="details.html#une-generalisation-de-la-statistique-t_f-lk">Une généralisation de la statistique <span class="math inline">\(T_{F-LK}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="informations-supplementaires.html"><a href="informations-supplementaires.html"><i class="fa fa-check"></i><b>B</b> Informations supplémentaires</a><ul>
<li class="chapter" data-level="" data-path="informations-supplementaires.html"><a href="informations-supplementaires.html#article-1-1"><i class="fa fa-check"></i>Article 1 </a></li>
<li class="chapter" data-level="" data-path="informations-supplementaires.html"><a href="informations-supplementaires.html#article-2-1"><i class="fa fa-check"></i>Article 2</a></li>
<li class="chapter" data-level="" data-path="informations-supplementaires.html"><a href="informations-supplementaires.html#article-3-1"><i class="fa fa-check"></i>Article 3</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="r-python.html"><a href="r-python.html"><i class="fa fa-check"></i><b>C</b> R &amp; Python</a><ul>
<li class="chapter" data-level="C.1" data-path="r-python.html"><a href="r-python.html#simulations-et-modeles-demographiques"><i class="fa fa-check"></i><b>C.1</b> Simulations et modèles démographiques</a><ul>
<li class="chapter" data-level="C.1.1" data-path="r-python.html"><a href="r-python.html#modele-en-ile"><i class="fa fa-check"></i><b>C.1.1</b> Modèle en île</a></li>
<li class="chapter" data-level="C.1.2" data-path="r-python.html"><a href="r-python.html#modele-de-divergence"><i class="fa fa-check"></i><b>C.1.2</b> Modèle de divergence</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliographie.html"><a href="bibliographie.html"><i class="fa fa-check"></i>Bibliographie</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Application de l’Analyse en Composantes Principales pour étudier l’adaptation biologique en génomique des populations.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aspect-computationnel" class="section level1">
<h1><span class="header-section-number">Chapitre 4</span> Aspect computationnel</h1>
<p>Dans cette partie, nous nous intéresserons brièvement à l’aspect computationnel des méthodes qui ont été présentées dans les chapitres précédents. Le développement d’outils logiciels destinés à l’exploration de données génétiques volumineuses requiert qu’une attention particulière soit portée à l’utilisation des ressources de calcul. Étant donné que nous nous intéressons à la possibilité de réaliser des scans génomiques pour des données génétiques de grande taille, il me semble intéressant de préciser les points sur lesquels des améliorations ont été faites d’un point de vue computationnel.</p>
<div id="evolution-de-pcadapt" class="section level2">
<h2><span class="header-section-number">4.1</span> Évolution de pcadapt</h2>
<div id="du-langage-c-au-langage-r" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Du langage C au langage R</h3>
<p>La première version de pcadapt a été implémentée par Nicolas Duforet-Frebourg. Le logiciel a été initialement développé en C mais nous avons décidé de poursuivre le développement du logiciel en R/Rcpp, afin de simplifier son utilisation et de bénéficier des performances du langage C++, mais surtout de la portabilité, des outils de visualisation et de documentation du langage R. La librairie pcadapt est disponible sur CRAN.</p>
</div>
<div id="du-calcul-de-la-matrice-de-covariance-a-lalgorithme-iram" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Du calcul de la matrice de covariance à l’algorithme IRAM</h3>
<p>Nous rappelons ici que nous nous intéressons seulement aux premières composantes principales obtenues avec l’ACP, ce qui signifie qu’il n’est pas nécessaire d’effectuer la décomposition en valeurs singulières (SVD) complète de la matrice d’apparentement génétique <span class="math inline">\(G_{RM} \in \mathcal{M}_{n}(\mathbb{R})\)</span> (où <span class="math inline">\(n\)</span> est le nombre d’individus). Il s’agit de ce que l’on appelle une décomposition en valeurs singulières tronquée. Pour effectuer l’ACP à partir d’une matrice de génotypes <span class="math inline">\(\tilde{G} \in \mathcal{M}_{np}(\mathbb{R})\)</span>, il est donc nécessaire de calculer la matrice d’apparentement génétique <span class="math inline">\(G_{RM}\)</span> pour ensuite calculer la SVD de <span class="math inline">\(G_{RM}\)</span>. En suivant cette procédure, le calcul de la matrice <span class="math inline">\(G_{RM}\)</span> est l’étape la plus coûteuse d’un point de vue algorithmique, car de complexité quadratique en le nombre d’individus. Cependant de nouvelles méthodes permettent d’effectuer la SVD tronquée de <span class="math inline">\(G_{RM}\)</span> sans qu’il n’y ait besoin de calculer explicitement <span class="math inline">\(G_{RM}\)</span>. La méthode que nous avons choisie d’utiliser pour le calcul de l’ACP est basée sur l’algorithme IRAM (Implicitly Restarted Arnoldi Method) <span class="citation">(Calvetti, Reichel, &amp; Sorensen, <a href="#ref-calvetti1994implicitly">1994</a>; Lehoucq &amp; Sorensen, <a href="#ref-lehoucq1996deflation">1996</a>)</span>.</p>
<p>L’algorithme IRAM repose sur l’idée que les vecteurs propres d’une matrice carrée <span class="math inline">\(A \in \mathcal{M}_{n}(\mathbb{R})\)</span> peuvent être estimés en construisant une base orthogonale de l’espace vectoriel <span class="math inline">\(\mathcal{K}_k(x) = \text{Vect}(x, Ax, A^2x, \dots, A^kx)\)</span> engendré par les itérations de <span class="math inline">\(A\)</span> où <span class="math inline">\(x \in \mathbb{R}^n\)</span> et <span class="math inline">\(k \in \mathbb{N}\)</span>. <span class="math inline">\(\mathcal{K}_k(x)\)</span> est connu sous le nom d’espace de Krylov. Dans notre cas, la matrice carrée que l’on souhaite décomposer est la matrice <span class="math inline">\(G_{RM}\)</span>. Pour construire les espaces de Krylov associés à <span class="math inline">\(G_{RM}\)</span>, il faut donc calculer les produits <span class="math inline">\(G_{RM}x\)</span>. Pour ne pas avoir à calculer <span class="math inline">\(G_{RM}\)</span> lors du calcul de <span class="math inline">\(G_{RM}x\)</span> (nous rappelons que <span class="math inline">\(G_{RM} = \frac{1}{p}\tilde{G}\tilde{G}^T\)</span>), il suffit de calculer d’abord <span class="math inline">\(y = \frac{1}{\sqrt{p}}\tilde{G}^Tx\)</span> puis <span class="math inline">\(\frac{1}{\sqrt{p}}\tilde{G}y\)</span>, résultant en un coût algorithmique linéaire en <span class="math inline">\(n\)</span> et en <span class="math inline">\(p\)</span>.</p>

<div class="figure" style="text-align: center"><span id="fig:svd-speed"></span>
<img src="thesis_files/figure-html/svd-speed-1.png" alt="Comparaison des temps de calcul pour la SVD tronquée de rang 2 obtenue avec la méthode classique et la méthode IRAM. Le nombre de variables est fixé à 10000 et le nombre d’observations varie de 25 à 1000. Nous constatons que pour un nombre d’observations élevé, l’algorithme IRAM est plus efficace que la méthode nécessitant de calculer la matrice de covariance." width="\textwidth" />
<p class="caption">
Figure 4.1: Comparaison des temps de calcul pour la SVD tronquée de rang 2 obtenue avec la méthode classique et la méthode IRAM. Le nombre de variables est fixé à 10000 et le nombre d’observations varie de 25 à 1000. Nous constatons que pour un nombre d’observations élevé, l’algorithme IRAM est plus efficace que la méthode nécessitant de calculer la matrice de covariance.
</p>
</div>
<div id="acp-et-valeurs-manquantes" class="section level4 unnumbered">
<h4>ACP et valeurs manquantes</h4>
<p>Pour tenir compte de la présence de données manquantes dans le calcul de l’ACP, plusieurs stratégies peuvent être envisagées <span class="citation">(Dray &amp; Josse, <a href="#ref-dray2015principal">2015</a>)</span> :</p>
<ul>
<li><p>Imputer : chaque entrée manquante est remplacée par une valeur et l’ACP est réalisée à partir de la matrice de génotypes complétée. Dans le logiciel flashpca par exemple, si la valeur <span class="math inline">\(G_{ij}\)</span> est manquante, elle complétée par la valeur moyenne observée sur le <span class="math inline">\(j\)</span>-ème locus <span class="citation">(Abraham &amp; Inouye, <a href="#ref-abraham2014fast">2014</a>)</span>. D’autres suggèrent encore d’utiliser des logiciels spécifiquement conçus pour l’imputation de données génétiques comme Beagle ou SHAPEIT <span class="citation">(Browning &amp; Browning, <a href="#ref-browning2016genotype">2016</a>; Delaneau, Marchini, &amp; Zagury, <a href="#ref-delaneau2012linear">2012</a>)</span>.</p></li>
<li><p>Tenir compte des données manquantes dans le calcul de <span class="math inline">\(G_{RM}\)</span> : lors du calcul de la corrélation entre deux individus <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span>, sont exclus du calcul tout marqueur génétique manquant chez l’individu <span class="math inline">\(i\)</span> ou <span class="math inline">\(j\)</span>.</p></li>
</ul>
<span class="math display" id="eq:GRM-missing">\[\begin{equation}
  G_{RM, ij} = \frac{1}{\sum_{k=1}^p \delta_{ik}\delta_{jk}} \sum_{k = 1}^p \frac{(G_{ik} - 2p_k) \times (G_{jk} - 2p_k)}{2p_k(1-p_k)} \delta_{ik} \delta_{jk}
  \tag{4.1}
\end{equation}\]</span>
<p>où <span class="math inline">\(\delta_{ik} = 0\)</span> si <span class="math inline">\(G_{ik}\)</span> est manquant et <span class="math inline">\(\delta_{ik} = 1\)</span> sinon. Dans le cas où il n’y a pas de valeur manquante, nous retrouvons bien l’expression donnée par l’équation <a href="adaptation-locale-1.html#eq:GRM">(2.5)</a>. Un exemple d’implémentation en Rcpp du calcul de <span class="math inline">\(G_{RM}\)</span> tenant compte des données manquantes est donné ci-dessous.</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span>
<span class="kw">using</span> <span class="kw">namespace</span> Rcpp;

<span class="co">// [[Rcpp::export]]</span>
NumericMatrix PairGRM(<span class="at">const</span> NumericMatrix &amp;G,
                      <span class="at">const</span> NumericVector &amp;p) {

  <span class="co">// In our algorithms, individuals are stored in columns and SNPs are stored</span>
  <span class="co">// in rows.</span>
  <span class="dt">int</span> nSNP = G.nrow(); <span class="co">// number of SNPs</span>
  <span class="dt">int</span> nIND = G.ncol(); <span class="co">// number of individuals</span>
  NumericMatrix GRM(nIND, nIND); <span class="co">// Genetic Relationship Matrix</span>

  <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; nIND; i++) {
    <span class="cf">for</span> (<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; nIND; j++) {

      <span class="co">// value = GRM(i, j)</span>
      <span class="dt">double</span> value = <span class="dv">0</span>;
      <span class="dt">double</span> tmp = <span class="dv">0</span>; 
      <span class="co">// number of missing values for each pair of individuals (i, j)</span>
      <span class="co">// nbmv = \sum_{k = 1}^{nSNP} \delta_{ik} \delta{jk}</span>
      <span class="dt">int</span> nbmv = <span class="dv">0</span>;

      <span class="co">// Loop over the SNPs to compute the dot product</span>
      <span class="cf">for</span> (<span class="dt">int</span> k = <span class="dv">0</span>; k &lt; nSNP; k++) {
        <span class="cf">if</span> ((!NumericVector::is_na(G(k, i))) &amp;&amp; 
            (!NumericVector::is_na(G(k, j)))) {
          tmp = (G(k, i) - <span class="dv">2</span> * p[k]) * (G(k, j) - <span class="dv">2</span> * p[k]);
          value +=  tmp / (<span class="dv">2</span> * p[k] * (<span class="dv">1</span> - p[k]));
        } <span class="cf">else</span> {
          nbmv++;
        }
      }
      <span class="co">// Divide by the number of non-missing values for (i, j)</span>
      GRM(i, j) = value / (nSNP - nbmv);
    }
  }
  <span class="cf">return</span> GRM;
}</code></pre></div>
</div>
<div id="algorithme-iram-et-donnees-manquantes" class="section level4 unnumbered">
<h4>Algorithme IRAM et données manquantes</h4>
<p>Cependant, comme cela a été dit dans le paragraphe précédent, nous souhaitons nous détacher du calcul de la matrice <span class="math inline">\(G_{RM}\)</span>. Nous avons donc cherché à adapter l’algorithme IRAM pour qu’il puisse tenir compte de la présence de données manquantes, à la manière de la fonction <code>PairGRM</code> décrite ci-dessus. Pour cela nous avons adopté la même démarche, mais en l’appliquant aux produits <span class="math inline">\(\tilde{G}^Tx\)</span> et <span class="math inline">\(\tilde{G}y\)</span> où <span class="math inline">\(x \in \mathbb{R}^n\)</span> et <span class="math inline">\(y \in \mathbb{R}^p\)</span>. Plus précisément, plutôt que de calculer <span class="math inline">\(\tilde{G}^Tx\)</span> et <span class="math inline">\(\tilde{G}y\)</span>, nous calculons les produits <span class="math inline">\(\frac{1}{n}\tilde{G}^Tx\)</span> et <span class="math inline">\(\frac{1}{p}\tilde{G}y\)</span> ce qui nous permet de tenir compte des données manquantes de la façon suivante :</p>
<span class="math display" id="eq:prodMatVec">\[\begin{equation}
  \forall j \in [|1,p|], \; \left(\frac{1}{n}\tilde{G}^Tx\right)_j = \frac{1}{\sum_{i=1}^n \delta_{ij}} \sum_{i = 1}^n \tilde{G}_{ij} \delta_{ij} x_i,  \\
  \forall i \in [|1,n|], \; \left(\frac{1}{p}\tilde{G}y\right)_i = \frac{1}{\sum_{j=1}^p \delta_{ij}} \sum_{j = 1}^p \tilde{G}_{ij} \delta_{ij} y_j,
  \tag{4.2}
\end{equation}\]</span>
<p>où <span class="math inline">\(\delta_{ij} = 0\)</span> si <span class="math inline">\(G_{ij}\)</span> est manquant et <span class="math inline">\(\delta_{ij} = 1\)</span> sinon. En l’absence de données manquantes, cette méthode donne une estimation du produit <span class="math inline">\(\frac{1}{np}\tilde{G}\tilde{G}^Tx = \frac{1}{n}G_{RM}x\)</span>, ce qui signifie que si l’on applique l’algorithme IRAM en utilisant les produits définis à l’équation <a href="aspect-computationnel.html#eq:prodMatVec">(4.2)</a>, nous nous retrouvons à effectuer la SVD de <span class="math inline">\(\frac{1}{n}G_{RM}\)</span> et non pas celle de <span class="math inline">\(G_{RM}\)</span>. Pour déduire la SVD de <span class="math inline">\(G_{RM}\)</span> à partir de la SVD de <span class="math inline">\(\frac{1}{n}G_{RM}\)</span>, il suffit simplement de multiplier les valeurs propres de <span class="math inline">\(\frac{1}{n}G_{RM}\)</span> par <span class="math inline">\(n\)</span>, les vecteurs propres étant les mêmes pour les deux décompositions (à une rotation près).</p>
</div>
<div id="precision-de-la-svd-en-presence-de-donnees-manquantes" class="section level4 unnumbered">
<h4>Précision de la SVD en présence de données manquantes</h4>
<p>Nous comparons ici les différentes méthodes dont nous avons parlé dans le paragraphe précédent, à savoir flashpca, PairGRM et notre nouvelle méthode. La comparaison est réalisée sur un échantillon du jeu de données POPRES. Nous évaluons la sensibilité des différentes méthodes à la présence de données manquantes en comparant les valeurs singulières et les scores de l’ACP obtenus par chacune des méthodes en présence de données manquantes aux valeurs singulières et scores de l’ACP obtenus avec flashpca en l’absence de données manquantes. Les résultats de cette comparaison sont donnés en figure</p>

<div class="figure" style="text-align: center"><span id="fig:missing-values-comparison"></span>
<img src="thesis_files/figure-html/missing-values-comparison-1.png" alt="Comparaison des scores d’ACP obtenus avec flashpca, PairGRM et pcadapt pour différentes proportions de valeurs manquantes distribuées uniformément. Nous calculons l’erreur moyenne quadratique (EMQ) pour le calcul des 5 premiers axes de l’ACP et 5 premières valeurs singulières." width="\textwidth" />
<p class="caption">
Figure 4.2: Comparaison des scores d’ACP obtenus avec flashpca, PairGRM et pcadapt pour différentes proportions de valeurs manquantes distribuées uniformément. Nous calculons l’erreur moyenne quadratique (EMQ) pour le calcul des 5 premiers axes de l’ACP et 5 premières valeurs singulières.
</p>
</div>
<p>En conclusion, la possibilité de déduire la SVD d’une matrice <span class="math inline">\(A\)</span> à partir de la SVD d’une matrice proportionnelle à celle-ci nous a permis d’adapter la méthode IRAM au cas de matrices contenant des données manquantes. Par ailleurs, d’après nos comparaisons numériques, notre nouvelle méthode est moins sensible à la présence de données manquantes.</p>
</div>
</div>
<div id="du-format-.pcadapt-au-format-.bed" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Du format .pcadapt au format .bed</h3>
<p>Le format .pcadapt stocke la matrice de génotypes dans un fichier texte où chaque ligne représente un marqueur génétique. Les caractères sont séparés par un espace et les valeurs manquantes sont encodées par des <code>9</code>. Ce format a été utilisé car le calcul de l’ACP pouvait être effectué sans qu’il n’y ait besoin de charger la matrice de génotypes dans la mémoire vive. La matrice <span class="math inline">\(G_{RM}\)</span> était alors calculée de façon incrémentale, en parcourant le fichier ligne par ligne (et donc SNP par SNP). Ce format, bien que très simple, présente quelques inconvénients :</p>
<ul>
<li><p>les espaces n’encodent aucune information. La moitié de l’espace mémoire occupée par le fichier est donc essentiellement vide d’un point de vue informatif.</p></li>
<li><p>les génotypes 0, 1, 2 et 9 sont encodés en ASCII et donc chaque valeur occupe un octet (ou 8 bits).</p></li>
</ul>
<p>Le logiciel PLINK <span class="citation">(Purcell et al., <a href="#ref-purcell2007plink">2007</a>)</span> dispose du format de fichier .bed qui présente bien plus d’avantages :</p>
<ul>
<li><p>le format .bed est un format de fichier binaire, l’accès à un fichier binaire est plus rapide que l’accès à un fichier texte.</p></li>
<li><p>sachant qu’il n’y a que 4 valeurs possibles pour un génotype, chaque génotype peut être encodé sur 2 bits (Table <a href="aspect-computationnel.html#tab:encoding-plink">4.1</a>).</p></li>
</ul>

<table>
<caption><span id="tab:encoding-plink">Table 4.1: </span>Encodage des génotypes dans le format .bed. Les génotypes sont encodés sur 2 bits ce qui permet de stocker 4 génotypes sur un octet, contrairement au format .pcadapt où chaque génotype est encodé sur un octet. Le quadruplet <code>2 1 NA 2</code> sera par exemple encodé par <code>11100111</code>.</caption>
<thead>
<tr class="header">
<th align="left">Génotype</th>
<th align="left">Encodage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">00</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">01</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">10</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">11</td>
</tr>
</tbody>
</table>
<p>Pour résumer, un fichier .bed et un fichier .pcadapt contiennent exactement la même information. Un fichier .bed occupe exactement 8 fois moins d’espace mémoire physique qu’un fichier au format .pcadapt. Nous avons donc décidé de développer nos algorithmes afin qu’ils puissent être directement utilisés sur des fichiers .bed sans qu’il n’y ait besoin de les convertir au format .pcadapt.</p>
</div>
</div>
<div id="interface-shiny" class="section level2">
<h2><span class="header-section-number">4.2</span> Interface Shiny</h2>
<p>Nous proposons également une interface graphique, basée sur la librairie Shiny, pour une utilisation simplifiée de nos outils statistiques. Cette interface se présente sous la forme d’une application web, et nécessite donc l’utilisation d’un navigateur web.</p>
<iframe src="https://keurcien.shinyapps.io/app-pcadapt?showcase=0" width="100%" height="400px">
</iframe>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-calvetti1994implicitly">
<p>Calvetti, D., Reichel, L., &amp; Sorensen, D. C. (1994). An implicitly restarted lanczos method for large symmetric eigenvalue problems. <em>Electronic Transactions on Numerical Analysis</em>, <em>2</em>(1), 21.</p>
</div>
<div id="ref-lehoucq1996deflation">
<p>Lehoucq, R. B., &amp; Sorensen, D. C. (1996). Deflation techniques for an implicitly restarted arnoldi iteration. <em>SIAM Journal on Matrix Analysis and Applications</em>, <em>17</em>(4), 789–821.</p>
</div>
<div id="ref-dray2015principal">
<p>Dray, S., &amp; Josse, J. (2015). Principal component analysis with missing values: A comparative survey of methods. <em>Plant Ecology</em>, <em>216</em>(5), 657–667.</p>
</div>
<div id="ref-abraham2014fast">
<p>Abraham, G., &amp; Inouye, M. (2014). Fast principal component analysis of large-scale genome-wide data. <em>PloS One</em>, <em>9</em>(4), e93766.</p>
</div>
<div id="ref-browning2016genotype">
<p>Browning, B. L., &amp; Browning, S. R. (2016). Genotype imputation with millions of reference samples. <em>The American Journal of Human Genetics</em>, <em>98</em>(1), 116–126.</p>
</div>
<div id="ref-delaneau2012linear">
<p>Delaneau, O., Marchini, J., &amp; Zagury, J.-F. (2012). A linear complexity phasing method for thousands of genomes. <em>Nature Methods</em>, <em>9</em>(2), 179–181.</p>
</div>
<div id="ref-purcell2007plink">
<p>Purcell, S., Neale, B., Todd-Brown, K., Thomas, L., Ferreira, M. A., Bender, D., … others. (2007). PLINK: A tool set for whole-genome association and population-based linkage analyses. <em>The American Journal of Human Genetics</em>, <em>81</em>(3), 559–575.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introgression-adaptative.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="perspectives-et-conclusions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": [["thesis.pdf", "PDF"], ["thesis.epub", "EPUB"], ["thesis.docx", "Word"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
