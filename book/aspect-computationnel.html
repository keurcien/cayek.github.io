<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Méthodes statistiques en grande dimension pour l’étude de l’adaptation biologique à l’aide de larges bases de données génomiques</title>
  <meta name="description" content="Méthodes statistiques en grande dimension pour l’étude de l’adaptation biologique à l’aide de larges bases de données génomiques">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Méthodes statistiques en grande dimension pour l’étude de l’adaptation biologique à l’aide de larges bases de données génomiques" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Méthodes statistiques en grande dimension pour l’étude de l’adaptation biologique à l’aide de larges bases de données génomiques" />
  
  
  

<meta name="author" content="Keurcien LUU">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introgression-adaptative.html">
<link rel="next" href="conclusion.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#la-genetique-des-populations"><i class="fa fa-check"></i><b>1.1</b> La génétique des populations</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#levolution-comme-point-de-depart"><i class="fa fa-check"></i><b>1.1.1</b> L’évolution comme point de départ</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#a-lorigine-de-la-variabilite-genetique"><i class="fa fa-check"></i><b>1.2</b> À l’origine de la variabilité génétique</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#la-theorie-de-levolution"><i class="fa fa-check"></i><b>1.2.1</b> La théorie de l’évolution</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#levolution-dune-theorie"><i class="fa fa-check"></i><b>1.2.2</b> L’évolution d’une théorie</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction.html"><a href="introduction.html#forces-evolutives"><i class="fa fa-check"></i><b>1.2.3</b> Forces évolutives</a></li>
<li class="chapter" data-level="1.2.4" data-path="introduction.html"><a href="introduction.html#adaptation-locale"><i class="fa fa-check"></i><b>1.2.4</b> Adaptation locale</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#donnees-de-polymorphismes-genetiques"><i class="fa fa-check"></i><b>1.3</b> Données de polymorphismes génétiques</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#des-donnees-en-grande-dimension"><i class="fa fa-check"></i><b>1.3.1</b> Des données en grande dimension</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#les-marqueurs-genetiques"><i class="fa fa-check"></i><b>1.3.2</b> Les marqueurs génétiques</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#encodage-des-donnees-genetiques"><i class="fa fa-check"></i><b>1.3.3</b> Encodage des données génétiques</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#les-motivations-de-la-these"><i class="fa fa-check"></i><b>1.4</b> Les motivations de la thèse</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html"><i class="fa fa-check"></i><b>2</b> Adaptation locale</a><ul>
<li class="chapter" data-level="2.1" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#letat-de-lart-pour-les-scans-genomiques"><i class="fa fa-check"></i><b>2.1</b> L’état de l’art pour les scans génomiques</a><ul>
<li class="chapter" data-level="2.1.1" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#modeles-demographiques"><i class="fa fa-check"></i><b>2.1.1</b> Modèles démographiques</a></li>
<li class="chapter" data-level="2.1.2" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#lindice-de-fixation"><i class="fa fa-check"></i><b>2.1.2</b> L’indice de fixation</a></li>
<li class="chapter" data-level="2.1.3" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#test-de-lewontin-krakauer"><i class="fa fa-check"></i><b>2.1.3</b> Test de Lewontin-Krakauer</a></li>
<li class="chapter" data-level="2.1.4" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#le-modele-f"><i class="fa fa-check"></i><b>2.1.4</b> Le modèle <span class="math inline">\(F\)</span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#lanalyse-en-composantes-principales-en-genetique-des-populations"><i class="fa fa-check"></i><b>2.2</b> L’Analyse en Composantes Principales en génétique des populations</a><ul>
<li class="chapter" data-level="2.2.1" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#principe-de-lanalyse-en-composantes-principales"><i class="fa fa-check"></i><b>2.2.1</b> Principe de l’Analyse en Composantes Principales</a></li>
<li class="chapter" data-level="2.2.2" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#apparentement-genetique-interindividuel"><i class="fa fa-check"></i><b>2.2.2</b> Apparentement génétique interindividuel</a></li>
<li class="chapter" data-level="2.2.3" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#applications-en-genetique-des-populations"><i class="fa fa-check"></i><b>2.2.3</b> Applications en génétique des populations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#statistiques-de-test-basees-sur-lanalyse-en-composantes-principales"><i class="fa fa-check"></i><b>2.3</b> Statistiques de test basées sur l’Analyse en Composantes Principales</a><ul>
<li class="chapter" data-level="2.3.1" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#la-communalite"><i class="fa fa-check"></i><b>2.3.1</b> La communalité</a></li>
<li class="chapter" data-level="2.3.2" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#la-distance-robuste-de-mahalanobis"><i class="fa fa-check"></i><b>2.3.2</b> La distance robuste de Mahalanobis</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#article-1"><i class="fa fa-check"></i><b>2.4</b> Article 1</a><ul>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#contributions"><i class="fa fa-check"></i>Contributions</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#resume"><i class="fa fa-check"></i>Résumé</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#abstract"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#significance-statement"><i class="fa fa-check"></i>Significance Statement</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#new-method"><i class="fa fa-check"></i>New Method</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#discussion"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#materials-and-methods"><i class="fa fa-check"></i>Materials and Methods</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#article-2"><i class="fa fa-check"></i><b>2.5</b> Article 2</a><ul>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#abstract-1"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#introduction-2"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#statistical-and-computational-approach"><i class="fa fa-check"></i>Statistical and computational approach</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#materials-and-methods-1"><i class="fa fa-check"></i>Materials and methods</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#results-1"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#discussion-1"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="adaptation-locale-1.html"><a href="adaptation-locale-1.html#data-accessibility"><i class="fa fa-check"></i>Data accessibility</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html"><i class="fa fa-check"></i><b>3</b> Introgression adaptative</a><ul>
<li class="chapter" data-level="3.1" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#methode-basee-sur-lutilisation-de-coefficients-de-metissage-locaux."><i class="fa fa-check"></i><b>3.1</b> Méthode basée sur l’utilisation de coefficients de métissage locaux.</a><ul>
<li class="chapter" data-level="3.1.1" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#coefficients-de-metissage-locaux"><i class="fa fa-check"></i><b>3.1.1</b> Coefficients de métissage locaux</a></li>
<li class="chapter" data-level="3.1.2" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#statistique-de-test"><i class="fa fa-check"></i><b>3.1.2</b> Statistique de test</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#methodes-basees-sur-la-diversite-nucleotidique."><i class="fa fa-check"></i><b>3.2</b> Méthodes basées sur la diversité nucléotidique.</a><ul>
<li class="chapter" data-level="" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#diversite-nucleotidique-par-paire-de-sequences"><i class="fa fa-check"></i>Diversité nucléotidique par paire de séquences</a></li>
<li class="chapter" data-level="3.2.1" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#le-modele-abba-baba"><i class="fa fa-check"></i><b>3.2.1</b> Le modèle ABBA-BABA</a></li>
<li class="chapter" data-level="3.2.2" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#analyse-en-composantes-principales-locale"><i class="fa fa-check"></i><b>3.2.2</b> Analyse en Composantes Principales locale</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#simulations"><i class="fa fa-check"></i><b>3.3</b> Simulations</a><ul>
<li class="chapter" data-level="3.3.1" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#donnees-de-peupliers"><i class="fa fa-check"></i><b>3.3.1</b> Données de peupliers</a></li>
<li class="chapter" data-level="3.3.2" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#generation-aleatoire-dindividus-hybrides"><i class="fa fa-check"></i><b>3.3.2</b> Génération aléatoire d’individus hybrides</a></li>
<li class="chapter" data-level="3.3.3" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#simulations-a-partir-de-ms-et-seq-gen"><i class="fa fa-check"></i><b>3.3.3</b> Simulations à partir de ms et Seq-Gen</a></li>
<li class="chapter" data-level="3.3.4" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#resultats-de-la-comparaison-des-logiciels"><i class="fa fa-check"></i><b>3.3.4</b> Résultats de la comparaison des logiciels</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#article-3"><i class="fa fa-check"></i><b>3.4</b> Article 3</a><ul>
<li class="chapter" data-level="" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#introduction-3"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#materials-and-methods-2"><i class="fa fa-check"></i>Materials and methods</a></li>
<li class="chapter" data-level="" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#results-2"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="introgression-adaptative.html"><a href="introgression-adaptative.html#discussion-2"><i class="fa fa-check"></i>Discussion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="aspect-computationnel.html"><a href="aspect-computationnel.html"><i class="fa fa-check"></i><b>4</b> Aspect computationnel</a><ul>
<li class="chapter" data-level="4.1" data-path="aspect-computationnel.html"><a href="aspect-computationnel.html#donnees-dentree"><i class="fa fa-check"></i><b>4.1</b> Données d’entrée</a></li>
<li class="chapter" data-level="4.2" data-path="aspect-computationnel.html"><a href="aspect-computationnel.html#memory-mapping"><i class="fa fa-check"></i><b>4.2</b> Memory-mapping</a></li>
<li class="chapter" data-level="4.3" data-path="aspect-computationnel.html"><a href="aspect-computationnel.html#interface-shiny"><i class="fa fa-check"></i><b>4.3</b> Interface Shiny</a></li>
<li class="chapter" data-level="4.4" data-path="aspect-computationnel.html"><a href="aspect-computationnel.html#acp-et-donnees-manquantes"><i class="fa fa-check"></i><b>4.4</b> ACP et données manquantes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i>Conclusion</a></li>
<li class="appendix"><span><b>Appendice</b></span></li>
<li class="chapter" data-level="A" data-path="details.html"><a href="details.html"><i class="fa fa-check"></i><b>A</b> Détails</a><ul>
<li class="chapter" data-level="A.0.1" data-path="details.html"><a href="details.html#rapport-entre-la-communalite-et-lindice-de-fixation"><i class="fa fa-check"></i><b>A.0.1</b> Rapport entre la communalité et l’indice de fixation</a></li>
<li class="chapter" data-level="A.0.2" data-path="details.html"><a href="details.html#lanalyse-en-composantes-principales-regularisee"><i class="fa fa-check"></i><b>A.0.2</b> L’Analyse en Composantes Principales régularisée</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="informations-supplementaires.html"><a href="informations-supplementaires.html"><i class="fa fa-check"></i><b>B</b> Informations supplémentaires</a><ul>
<li class="chapter" data-level="" data-path="informations-supplementaires.html"><a href="informations-supplementaires.html#article-1-1"><i class="fa fa-check"></i>Article 1 </a></li>
<li class="chapter" data-level="" data-path="informations-supplementaires.html"><a href="informations-supplementaires.html#article-2-1"><i class="fa fa-check"></i>Article 2</a></li>
<li class="chapter" data-level="" data-path="informations-supplementaires.html"><a href="informations-supplementaires.html#article-3-1"><i class="fa fa-check"></i>Article 3</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="r-python.html"><a href="r-python.html"><i class="fa fa-check"></i><b>C</b> R &amp; Python</a><ul>
<li class="chapter" data-level="C.1" data-path="r-python.html"><a href="r-python.html#simulations-et-modeles-demographiques"><i class="fa fa-check"></i><b>C.1</b> Simulations et modèles démographiques</a><ul>
<li class="chapter" data-level="C.1.1" data-path="r-python.html"><a href="r-python.html#modele-en-ile"><i class="fa fa-check"></i><b>C.1.1</b> Modèle en île</a></li>
<li class="chapter" data-level="C.1.2" data-path="r-python.html"><a href="r-python.html#modele-de-divergence"><i class="fa fa-check"></i><b>C.1.2</b> Modèle de divergence</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="r-python.html"><a href="r-python.html#details-1"><i class="fa fa-check"></i><b>C.2</b> Détails</a><ul>
<li class="chapter" data-level="C.2.1" data-path="r-python.html"><a href="r-python.html#donnees-manquantes"><i class="fa fa-check"></i><b>C.2.1</b> Données manquantes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliographie.html"><a href="bibliographie.html"><i class="fa fa-check"></i>Bibliographie</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Méthodes statistiques en grande dimension pour l’étude de l’adaptation biologique à l’aide de larges bases de données génomiques</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aspect-computationnel" class="section level1">
<h1><span class="header-section-number">Chapitre 4</span> Aspect computationnel</h1>
<p>Dans cette partie, nous nous intéresserons brièvement à l’aspect computationnel des méthodes qui ont été présentées dans les chapitres précédents. Le développement d’outils logiciels destinés à l’exploration de données génétiques volumineuses requiert qu’une attention toute particulière soit portée à l’utilisation des ressources de calcul. Étant donné que nous nous intéressons à la possibilité de réaliser des scans génomiques pour des données génétiques de grande taille, il me semble intéressant de préciser les points sur lesquels des améliorations ont été faites d’un point de vue computationnel.</p>
<p>Blockwise computation of covariance matrix Random SVD Storage in binary format Memory-mapping</p>
<div id="donnees-dentree" class="section level2">
<h2><span class="header-section-number">4.1</span> Données d’entrée</h2>
<p>La matrice de génotype est stockée dans un fichier texte où chaque ligne représente un marqueur génétique. Les caractères sont séparés par un espace et les valeurs manquantes sont encodées par des <code>9</code>. Ce format a été utilisé car le calcul de l’ACP pouvait être effectué en parcourant une seule fois le fichier, ligne par ligne, correspondant au sens de lecture du fichier.</p>
<p>Ce format, bien que très simple, n’est en réalité pas adapté au traitement informatique. Il présente plusieurs désavantages :</p>
<ul>
<li><p>Les espaces n’encodent aucune information. La moitié de l’espace mémoire occupée par le fichier est donc essentiellement vide d’un point de vue informatif.</p></li>
<li><p>Les génotypes 0, 1, 2 et 9 sont encodés en ASCII, comme tout caractère (au sens informatique du terme), sur un octet (ou 8 bits). Si bien qu’un octet peut en réalité contenir l’information de quatre génotypes (2 bits par génotype). Si l’on s’en réfère au format .bed, les génotypes sont encodés de la façon suivante :</p></li>
</ul>
<p>A DETAILLER</p>
<ul>
<li><p>L’accès en lecture à un fichier texte est bien moins rapide que l’accès à un fichier binaire.</p></li>
<li><p>Le format .pcadapt n’est utilisé que par pcadapt.</p></li>
</ul>
<p>Pour résumer, un fichier .bed et un fichier .pcadapt contiennent exactement la même information. Un fichier .bed occupe exactement 8 fois moins d’espace mémoire physique d’un fichier .pcadapt. Même sans tenir compte de la vitesse de lecture, selon que l’on lit un fichier binaire ou un fichier texte, il est 8 fois plus rapide de récupérer une entrée de la matrice de génotype.</p>
</div>
<div id="memory-mapping" class="section level2">
<h2><span class="header-section-number">4.2</span> Memory-mapping</h2>
<p>La version C de PCAdapt utilisait le fait qu’il était possible de calculer la matrice de covariance entre les individus en stockant un certain nombre de SNPs à chaque fois. Afin de ne pas charger entièrement la matrice de génotypes dans la mémoire vive, les valeurs de la matrice étaient lues depuis le fichier. Les principaux inconvénients de cette façon de procéder résident dans l’accès au fichier en tant que <em>stream</em> :</p>
<ul>
<li><p>Accès lent</p></li>
<li><p>Accès aléatoire impossible<a href="#fn16" class="footnoteRef" id="fnref16"><sup>16</sup></a>.</p></li>
</ul>
<p>La library C++ <code>boost</code> permet de <em>mapper</em> un fichier, créant des accès aléatoires à ce fichier sans qu’il y ait besoin de charger le fichier.</p>
</div>
<div id="interface-shiny" class="section level2">
<h2><span class="header-section-number">4.3</span> Interface Shiny</h2>
<p>Grâce au logiciel R, il est possible de pousser encore plus loin la simplification d’utilisation des logiciels et des packages développés. À l’instar du package adegenet, nous proposons une interface web utilisable localement et facilement déployable sur des serveurs distants.</p>

<div class="figure" style="text-align: center"><span id="fig:shiny-app"></span>
<iframe src="https://keurcien.shinyapps.io/app-pcadapt?showcase=0" width="100%" height="400px">
</iframe>
<p class="caption">
Figure 4.1: Interface Shiny de la librairie pcadapt.
</p>
</div>
</div>
<div id="acp-et-donnees-manquantes" class="section level2">
<h2><span class="header-section-number">4.4</span> ACP et données manquantes</h2>
<p>Pour rappel, en génétique des populations, réaliser l’ACP sur des données de génômes consiste à faire la décomposition en valeurs singulières de la matrice de relation génétique.</p>
<span class="math display">\[\begin{equation}
  GRM_{ij} = \frac{1}{p} \sum_{k = 1}^p \frac{(G_{ki} - 2p_k) \times (G_{kj} - 2p_k)}{2p_i(1-p_i)}
\end{equation}\]</span>
<p>Pour tenir compte de la présence de données manquantes, plusieurs stratégies peuvent être envisagées <span class="citation">(Dray &amp; Josse, <a href="#ref-dray2015principal">2015</a>)</span> :</p>
<ul>
<li><p>Imputer : remplacer chaque entrée manquante par une valeur qu’elle peut potentiellement prendre. Certaines méthodes imputent les valeurs manquantes par les moyennes correspondantes <span class="citation">(Abraham &amp; Inouye, <a href="#ref-abraham2014fast">2014</a>)</span>, ou suggèrent d’utiliser des logiciels destinés à l’imputation <span class="citation">(Browning &amp; Browning, <a href="#ref-browning2016genotype">2016</a>; Delaneau, Marchini, &amp; Zagury, <a href="#ref-delaneau2012linear">2012</a>)</span>.</p></li>
<li><p>Tenir compte des données manquantes dans le calcul d’estimateurs : par exemple pour calculer la corrélation entre deux individus <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span>, sont exclus du calcul tout marqueur génétique manquant chez l’individu <span class="math inline">\(i\)</span> ou <span class="math inline">\(j\)</span>. La relation <a href="adaptation-locale-1.html#eq:GRM">(2.5)</a> devient alors :</p></li>
</ul>
<span class="math display" id="eq:GRM-missing">\[\begin{equation}
  GRM_{ij} = \frac{1}{\sum_{k=1}^p \delta_{ki}\delta_{kj}} \sum_{k = 1}^p \frac{(G_{ki} - 2p_k) \times (G_{kj} - 2p_k)}{2p_k(1-p_k)} \delta_{ki} \delta_{kj}
  \tag{4.1}
\end{equation}\]</span>
<p>où <span class="math inline">\(\delta_{ki} = 0\)</span> si <span class="math inline">\(G_{ki}\)</span> est manquant et <span class="math inline">\(\delta_{ki} = 1\)</span> sinon.</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="ot">#include &lt;Rcpp.h&gt;</span>
<span class="kw">using</span> <span class="kw">namespace</span> Rcpp;

<span class="co">// [[Rcpp::export]]</span>
NumericMatrix PairGRM(<span class="dt">const</span> NumericMatrix &amp;G,
                      <span class="dt">const</span> NumericVector &amp;p) {

  <span class="dt">int</span> nSNP = G.nrow(); <span class="co">// number of SNPs</span>
  <span class="dt">int</span> nIND = G.ncol(); <span class="co">// number of individuals</span>
  NumericMatrix GRM(nIND, nIND); <span class="co">// Genetic Relationship Matrix</span>

  <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; nIND; i++) {
    <span class="kw">for</span> (<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; nIND; j++) {

      <span class="co">// value = GRM(i, j)</span>
      <span class="dt">double</span> value = <span class="dv">0</span>;
      <span class="dt">double</span> tmp = <span class="dv">0</span>; 
      <span class="co">// number of missing values for each pair of individuals (i, j)</span>
      <span class="co">// nbmv = \sum_{k = 1}^{nSNP} \delta_{ki} \delta{kj}</span>
      <span class="dt">int</span> nbmv = <span class="dv">0</span>;

      <span class="co">// Loop over the SNPs to compute the dot product</span>
      <span class="kw">for</span> (<span class="dt">int</span> k = <span class="dv">0</span>; k &lt; nSNP; k++) {
        <span class="kw">if</span> ((!NumericVector::is_na(G(k, i))) &amp;&amp; 
            (!NumericVector::is_na(G(k, j)))) {
          tmp = (G(k, i) - <span class="dv">2</span> * p[k]) * (G(k, j) - <span class="dv">2</span> * p[k]);
          value +=  tmp / (<span class="dv">2</span> * p[k] * (<span class="dv">1</span> - p[k]));
        } <span class="kw">else</span> {
          nbmv++;
        }
      }

      <span class="co">// Divide by the number of non-missing values for (i, j)</span>
      GRM(i, j) = value / (nSNP - nbmv);

    }
  }

  <span class="kw">return</span> GRM;

}</code></pre></div>
<p>Le calcul de la matrice des relations génétiques affiche une complexité algorithmique en <span class="math inline">\(O(pn^2)\)</span> et est donc très coûteux d’un point de vue computationnel. Des méthodes provenant de la théorie des matrices aléatoires proposent des algorithmes permettant d’effectuer la décomposition en valeurs singulières en <span class="math inline">\(O(pn)\)</span> <span class="citation">(Baglama &amp; Reichel, <a href="#ref-baglama2005augmented">2005</a>)</span>. Cependant, la littérature est assez peu fournie quant à la possibilité d’utiliser ces méthodes à des données comportant des données manquantes <span class="citation">(Baglama &amp; Reichel, <a href="#ref-baglama2005augmented">2005</a>)</span>. Nous proposons ici une façon de compter</p>
<p>Bien évidemment cela ne dépend pas uniquement des algorithmes utilisés et il faut aussi tenir compte des ressources de calcul mises à disposition des utilisateurs. Nous avons néanmoins pris le parti de proposer un outil permettant de réaliser des scans génomiques pour la sélection sur des données pouvant contenir jusqu’à plusieurs millions de marqueurs génétiques génotypés pour plusieurs milliers d’individus, sans que cela ne requiert une utilisation démesurée de mémoire vive.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-dray2015principal">
<p>Dray, S., &amp; Josse, J. (2015). Principal component analysis with missing values: A comparative survey of methods. <em>Plant Ecology</em>, <em>216</em>(5), 657–667.</p>
</div>
<div id="ref-abraham2014fast">
<p>Abraham, G., &amp; Inouye, M. (2014). Fast principal component analysis of large-scale genome-wide data. <em>PloS One</em>, <em>9</em>(4), e93766.</p>
</div>
<div id="ref-browning2016genotype">
<p>Browning, B. L., &amp; Browning, S. R. (2016). Genotype imputation with millions of reference samples. <em>The American Journal of Human Genetics</em>, <em>98</em>(1), 116–126.</p>
</div>
<div id="ref-delaneau2012linear">
<p>Delaneau, O., Marchini, J., &amp; Zagury, J.-F. (2012). A linear complexity phasing method for thousands of genomes. <em>Nature Methods</em>, <em>9</em>(2), 179–181.</p>
</div>
<div id="ref-baglama2005augmented">
<p>Baglama, J., &amp; Reichel, L. (2005). Augmented implicitly restarted lanczos bidiagonalization methods. <em>SIAM Journal on Scientific Computing</em>, <em>27</em>(1), 19–42.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="16">
<li id="fn16"><p>l’accès aléatoire (pour une matrice) correspond au fait de pouvoir accéder à l’élément <span class="math inline">\((i, j)\)</span> de la matrice sans avoir à lire les valeurs qui le précèdent.<a href="aspect-computationnel.html#fnref16">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introgression-adaptative.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": [["thesis.pdf", "PDF"], ["thesis.epub", "EPUB"], ["thesis.docx", "Word"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
